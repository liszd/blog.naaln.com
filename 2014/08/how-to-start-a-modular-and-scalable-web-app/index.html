<!DOCTYPE html>




<html class="theme-next muse" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="google-site-verification" content="ByVfaP_E3b9ZYRUGhNAUFSQKL8mJQwUehpQwoxJ5n-c" />



  <meta name="msvalidate.01" content="DB220684085BEDBD2E49E8E942534B1F" />


















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.0.2" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/favicon/apple-touch-icon-next.png?v=6.0.2">


  <link rel="icon" type="image/png" sizes="32x32" href="/favicon/favicon-32x32-next.png?v=6.0.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/favicon/favicon-16x16-next.png?v=6.0.2">


  <link rel="mask-icon" href="/favicon/logo.svg?v=6.0.2" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.0.2',
    sidebar: {"position":"right","display":"hide","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: 'XILKIWTAM9',
      apiKey: '8c01137fe05d281ccd531a0ec622322a',
      indexName: 'blog',
      hits: {"per_page":10},
      labels: {"input_placeholder":"搜索文章","hits_empty":"啊，找不到 ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  
  <meta name="keywords" content="web," />


<meta name="description" content="虽然从没有认为自己是一个前端开发者，但不知不觉中也积累下了一些前端开发的经验。正巧之前碰到一道面试题，于是就顺便梳理了一下自己关于Web App的一些思路并整理为本文。 对于很多简单的网站或Web应用来说，引入jQuery以及一些插件，在当前页面内写入简单逻辑已经可以满足大部分需要。但是如果一旦多人开发，应用的复杂程度上升，就会有很多问题开始暴露出来：  数据源一般都与页面分离，那么App启动一般">
<meta name="keywords" content="web">
<meta property="og:type" content="article">
<meta property="og:title" content="如何开始一个模块化可扩展的Web App">
<meta property="og:url" content="https://blog.naaln.com/2014/08/how-to-start-a-modular-and-scalable-web-app/index.html">
<meta property="og:site_name" content="Why·Liam·Blog">
<meta property="og:description" content="虽然从没有认为自己是一个前端开发者，但不知不觉中也积累下了一些前端开发的经验。正巧之前碰到一道面试题，于是就顺便梳理了一下自己关于Web App的一些思路并整理为本文。 对于很多简单的网站或Web应用来说，引入jQuery以及一些插件，在当前页面内写入简单逻辑已经可以满足大部分需要。但是如果一旦多人开发，应用的复杂程度上升，就会有很多问题开始暴露出来：  数据源一般都与页面分离，那么App启动一般">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2017-09-03T09:15:57.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="如何开始一个模块化可扩展的Web App">
<meta name="twitter:description" content="虽然从没有认为自己是一个前端开发者，但不知不觉中也积累下了一些前端开发的经验。正巧之前碰到一道面试题，于是就顺便梳理了一下自己关于Web App的一些思路并整理为本文。 对于很多简单的网站或Web应用来说，引入jQuery以及一些插件，在当前页面内写入简单逻辑已经可以满足大部分需要。但是如果一旦多人开发，应用的复杂程度上升，就会有很多问题开始暴露出来：  数据源一般都与页面分离，那么App启动一般">



  <link rel="alternate" href="/atom.xml" title="Why·Liam·Blog" type="application/atom+xml" />




  <link rel="canonical" href="https://blog.naaln.com/2014/08/how-to-start-a-modular-and-scalable-web-app/"/>


  <title>如何开始一个模块化可扩展的Web App | Why·Liam·Blog</title>
  




<script async src="https://www.googletagmanager.com/gtag/js?id=UA-47966442-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-47966442-2');
</script>






  
<script src="//msite.baidu.com/sdk/c.js?appid=1586840953097399"></script>
<link rel="canonical" href="https://blog.naaln.com/2014/08/how-to-start-a-modular-and-scalable-web-app/"/>
<script type="application/ld+json">
    {
        "@context": "https://ziyuan.baidu.com/contexts/cambrian.jsonld",
        "@id": "https://blog.naaln.com/2014/08/how-to-start-a-modular-and-scalable-web-app/",
        "appid": "1586840953097399",
        "title": "如何开始一个模块化可扩展的Web App",
        "images": [
            ""
            ],
        "description": "",
        "pubDate": "",
        "upDate": "",
        "lrDate": ""
    }
</script>

  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"> <div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Why·Liam·Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">人生若如初見</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-home"></i> <br />首页</a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />归档</a>
        </li>
      
        
        <li class="menu-item menu-item-technology">
          <a href="/categories/technology/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-code"></i> <br />技术</a>
        </li>
      
        
        <li class="menu-item menu-item-jottings">
          <a href="/categories/jottings/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-language"></i> <br />随笔</a>
        </li>
      
        
        <li class="menu-item menu-item-tour">
          <a href="/categories/tour/" rel="section">
            <i class="menu-item-icon fa fa-fw fa-globe"></i> <br />旅游</a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />搜索</a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>


  



 </div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.naaln.com/2014/08/how-to-start-a-modular-and-scalable-web-app/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="WHY·LIAM">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="//tva2.sinaimg.cn/crop.0.0.998.998.180/48910e01gw1ef5p6etuzdj20rs0rs771.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Why·Liam·Blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">如何开始一个模块化可扩展的Web App</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2014-08-11T11:33:00+08:00">2014-08-11</time>
            

            
            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/technology/" itemprop="url" rel="index"><span itemprop="name">技术</span></a></span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-comment-o"></i>
              </span>
              
                <a href="/2014/08/how-to-start-a-modular-and-scalable-web-app/#SOHUCS" itemprop="discussionUrl">
                  <span id="changyan_count_unit" class="post-comments-count hc-comment-count" data-xid="2014/08/how-to-start-a-modular-and-scalable-web-app/" itemprop="commentsCount"></span>
                </a>
              
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>虽然从没有认为自己是一个前端开发者，但不知不觉中也积累下了一些前端开发的经验。正巧之前碰到一道面试题，于是就顺便梳理了一下自己关于Web App的一些思路并整理为本文。</p>
<p>对于很多简单的网站或Web应用来说，引入jQuery以及一些插件，在当前页面内写入简单逻辑已经可以满足大部分需要。但是如果一旦多人开发，应用的复杂程度上升，就会有很多问题开始暴露出来：</p>
<ol>
<li>数据源一般都与页面分离，那么App启动一般都需要等待数据源读入。</li>
<li>UI交互复杂时，需要将逻辑通过面向对象抽象后才能更好的复用。</li>
<li>功能间一般都存在依赖关系，需要引入支持依赖关系的模块加载器。 那么如何解决这些问题，就以一个简单的订餐App为例，从零开始一个<a href="http://avnpc.com/pages/start-a-modular-extensible-webapp" target="_blank" rel="noopener">模块化可扩展Web App</a>。</li>
</ol>
<p>这个简单的App基于HTML5 Boilerplate、requireJS、jQuery Mobile、Underscore.js，后端逻辑用jStorage模拟实现。完成后的成品<a href="http://allovince.github.com/webapp-startup/" target="_blank" rel="noopener">在此</a>。所有代码可以在github查看。下文将逐一介绍实现的思路与方法。</p>
<h3 id="从选择一个好模板开始"><a href="#从选择一个好模板开始" class="headerlink" title="从选择一个好模板开始"></a>从选择一个好模板开始</h3><p>开始一个Web项目，HTML的书写总是重中之重，一个好的HTML能从根源上规避大量潜在问题，所以Web App应该全部应用一个标准化的高质量HTML模板，而不是将所有页面交由开发人员自由发挥。</p>
<p>这里推荐使用<a href="http://html5boilerplate.com/" target="_blank" rel="noopener">HTML5 Boilerplate</a>项目作为App的默认模板以及文件路径规范，无论是网站或者富UI的App，都可以采用这个模板作为起步。</p>
<p>可以使用</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="keyword">clone</span> <span class="title">git</span>://github.com/h5bp/html5-boilerplate.git</span><br></pre></td></tr></table></figure>
<p>或者直接下载<a href="https://github.com/h5bp/html5-boilerplate" target="_blank" rel="noopener">HTML5 Boilerplate</a>项目代码。HTML5 Boilerplate的文件结构如下，</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">├── css</span><br><span class="line">│   ├── main.css</span><br><span class="line">│   └── normalize.css</span><br><span class="line">├── doc</span><br><span class="line">├── img</span><br><span class="line">├── js</span><br><span class="line">│   ├── main.js</span><br><span class="line">│   ├── plugins.js</span><br><span class="line">│   └── vendor</span><br><span class="line">│       ├── jquery<span class="selector-class">.min</span><span class="selector-class">.js</span></span><br><span class="line">│       └── modernizr<span class="selector-class">.min</span><span class="selector-class">.js</span></span><br><span class="line">├── .htaccess</span><br><span class="line">├── <span class="number">404</span>.html</span><br><span class="line">├── index.html</span><br><span class="line">├── humans.txt</span><br><span class="line">├── robots.txt</span><br><span class="line">├── crossdomain.xml</span><br><span class="line">├── favicon.ico</span><br><span class="line">└── [apple-touch-icons]</span><br><span class="line">```</span><br></pre></td></tr></table></figure>
<p>从上向下看</p>
<ul>
<li><code>css</code> 用于存放css文件，并内置了Normalize.css作为默认CSS重置手段（其实Normalize.css不能算是CSS reset）。</li>
<li><code>doc</code> 存放项目文档</li>
<li><code>img</code> 存放项目图片</li>
<li><code>js</code> 存放javascript文件，其中第三方类库推荐放在vendor下</li>
<li><code>.htaccess</code> 内置了很多对于静态文件在Apache下的优化策略，如果Web服务器不是Apache则可以参考其他Web服务器配置优化。</li>
<li><code>404.html</code> 默认的404页面，</li>
<li><code>index.html</code> 项目模板</li>
<li><code>humans.txt</code> 相对于面向机器人的robots.txt，humans.txt更像是小幽默，这在里可以写关于项目/团队的介绍，或者放置一些彩蛋给那些喜欢对你的应用刨根问底的用户们。</li>
<li><code>robots.txt</code> 用于告诉搜索引擎蜘蛛爬行规则</li>
<li><code>crossdomain.xml</code> 用于配置Flash的跨域策略</li>
<li><code>favicon.ico</code> <code>apple-touch-icon.png</code>等小图标。 如果是一个主要面向移动设备，还有更具针对性的<a href="http://html5boilerplate.com/mobile/" target="_blank" rel="noopener">Mobile Boilerplate</a>可供参考。</li>
</ul>
<h3 id="制定统一的编码规范"><a href="#制定统一的编码规范" class="headerlink" title="制定统一的编码规范"></a>制定统一的编码规范</h3><p>在正式开始编码之前，无论是多大规模的应用，多少人的团队，一定要有一个统一的规范，才能保证后续的开发不会乱套。</p>
<p>前端规范其实又要分为三部分：HTML、CSS、Javascript应该分别有自己的规范。HTML/CSS主要约定id/class的命名规则、属性的书写顺序。JavaScript可能需要细化到缩进、编码风格、面向对象写法等等。</p>
<p>最省事的方法当然还是参考已有的规范，比如<a href="https://google.github.io/styleguide/htmlcssguide.xml" target="_blank" rel="noopener">Google的HTML/CSS风格指南</a>、<a href="https://google.github.io/styleguide/jsguide.html" target="_blank" rel="noopener">Google的Javascript编码指南</a>等等。</p>
<h4 id="HTML篇"><a href="#HTML篇" class="headerlink" title="HTML篇"></a>HTML篇</h4><p><code>HTML5 Boilerplate</code>的模板核心部分不过30行，但是每一行都可谓千锤百炼，可以用最小的消耗解决一些前端的顽固问题：</p>
<p><strong>使用条件注释区分IE浏览器</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="comment">&lt;!--[if lt IE 7]&gt; &lt;html class="no-js lt-ie9 lt-ie8 lt-ie7"&gt; &lt;![endif]--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--[if IE 7]&gt;    &lt;html class="no-js lt-ie9 lt-ie8"&gt; &lt;![endif]--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--[if IE 8]&gt;    &lt;html class="no-js lt-ie9"&gt; &lt;![endif]--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--[if gt IE 8]&gt; &lt;html class="no-js"&gt; &lt;![endif]--&gt;</span></span><br></pre></td></tr></table></figure>
<p>之所以要这样写</p>
<ol>
<li>可以使用class作为全局条件区分低版本的IE浏览器并进行调整，这显然要优于使用CSS Hack。</li>
<li>可以避免<a href="http://webforscher.wordpress.com/2010/05/20/ie-6-slowing-down-ie-8/" target="_blank" rel="noopener">IE6条件注释引起的高版本IE文件阻塞问题</a>，原文的解决方法是在前面加一个空白的条件注释，但是这里显然将原本无用空白的条件注释变得有意义了。</li>
<li>仍然可以通过HTML验证。</li>
<li>与Modernizr等特征检测类库使用相同的class，更具备通用性。</li>
</ol>
<p><code>no-js</code>标签是需要与Modernizr等类库配合使用的，如果你不想在项目中引入Modernizr，需要在Head部分加入一行使<code>no-js</code>标签变为<code>js</code>，代码来自<a href="http://paulirish.com/2009/avoiding-the-fouc-v3/" target="_blank" rel="noopener">Avoiding the FOUC</a>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript">(<span class="function"><span class="keyword">function</span>(<span class="params">H</span>)</span>&#123;H.className=H.className.replace(<span class="regexp">/\bno-js\b/</span>,<span class="string">'js'</span>)&#125;)(<span class="built_in">document</span>.documentElement)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>通过上面的条件注释，就可以在CSS中针对不同情况分别处理</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.lt-ie7</span> &#123;&#125; <span class="comment">/* IE6等版本时 */</span></span><br><span class="line"><span class="selector-class">.no-js</span> &#123;&#125; <span class="comment">/* JavaScript没有启用时 */</span></span><br></pre></td></tr></table></figure>
<h4 id="meta标签的书写顺序"><a href="#meta标签的书写顺序" class="headerlink" title="meta标签的书写顺序"></a>meta标签的书写顺序</h4><p>为了让浏览器识别正确的编码，meta charset标签应该先于title标签出现。</p>
<p><code>meta X-UA-Compatible</code>标签可以指定IE8以上版本浏览器以最高级模式渲染文档，同时如果已经安装<a href="http://www.google.com/chromeframe?quickenable=true" target="_blank" rel="noopener">Google Chrome Frame</a>则直接使用Chrome Frame渲染。而指定渲染模式的<a href="http://msdn.microsoft.com/en-us/library/cc288325%28VS.85%29.aspx" target="_blank" rel="noopener">meta X-UA-Compatible</a>标签同样需要优先出现</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge,chrome=1"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="设置移动设备显示窗口宽度"><a href="#设置移动设备显示窗口宽度" class="headerlink" title="设置移动设备显示窗口宽度"></a>设置移动设备显示窗口宽度</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;meta <span class="attribute">name</span>=<span class="string">"viewport"</span> <span class="attribute">content</span>=<span class="string">"width=device-width"</span>/&gt;</span><br></pre></td></tr></table></figure>
<p>这是移动设备专属的标签，具体设置需要根据项目实际情况调整。</p>
<h4 id="使用Modernizr做浏览器差异检测"><a href="#使用Modernizr做浏览器差异检测" class="headerlink" title="使用Modernizr做浏览器差异检测"></a>使用Modernizr做浏览器差异检测</h4><p><a href="http://modernizr.com/" target="_blank" rel="noopener">Modernizr</a>常做前端的应该都不陌生。引入Modernizr后，html标签的no-js将会被自动替换为js，同时Modernizr会向html标签添加代表版本检测结果的class。</p>
<p>对于低版本浏览器的向上兼容需要根据项目实际需求处理，Modernizr也非常周到的给出的<a href="https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills" target="_blank" rel="noopener">绝大多数HTML5功能的兼容方法</a>。</p>
<h3 id="CSS篇"><a href="#CSS篇" class="headerlink" title="CSS篇"></a>CSS篇</h3><h4 id="CSS重置及增强功能"><a href="#CSS重置及增强功能" class="headerlink" title="CSS重置及增强功能"></a>CSS重置及增强功能</h4><p>HTML5 Boilerplate选择<a href="https://github.com/necolas/normalize.css" target="_blank" rel="noopener">Normalize.css</a>重置CSS。如果项目计划引入Twitter Bootstrap、YUI 3这些前端框架的话则可以移除，因为这些框架已经内置了Normalize.css。</p>
<p>同时HTML5 Boilerplate又引入了一个main.css，内置了一些基本的排版样式以及打印样式。</p>
<h4 id="使用LESS或Sass生成CSS"><a href="#使用LESS或Sass生成CSS" class="headerlink" title="使用LESS或Sass生成CSS"></a>使用LESS或Sass生成CSS</h4><p>在复杂应用中，如果还手写CSS的话将是一件痛苦的事情，大量的class前缀，复用样式需要来回copy等等。为了更好的扩展性，这里建议在项目中引入<a href="http://lesscss.org/" target="_blank" rel="noopener">LESS</a>或<a href="http://sass-lang.com/" target="_blank" rel="noopener">Sass</a>。这代表着：</p>
<ul>
<li>支持变量与简单运算</li>
<li>支持CSS片段复用</li>
<li>class/id样式嵌套</li>
</ul>
<p>等一些更像是编程语言的特性。这对于提高开发效率是效果非常明显的。</p>
<p>以LESS为例，简单介绍一下LESS在Windows下如何应用到这个项目中：</p>
<p>1. 下载<a href="http://nodejs.org/" target="_blank" rel="noopener">Nodejs</a>并安装，nodejs会自动将自己加入系统路径。</p>
<p>2. 在cmd运行</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> -g <span class="keyword">less</span></span><br></pre></td></tr></table></figure>
<p>3. 然后就可以通过lessc指令将less源文件编译为css</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">lessc</span> <span class="selector-tag">avnpc</span><span class="selector-class">.less</span> <span class="selector-tag">avnpc</span><span class="selector-class">.css</span></span><br></pre></td></tr></table></figure>
<p>如果不使用nodeJs作为后端，最好在写LESS时采用watch模式，每次保存自动编译为css。这里需要安装一个辅助模块recess：</p>
<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm <span class="keyword">install</span> -g recess</span><br></pre></td></tr></table></figure>
<p>然后运行watch</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">recess avnpc<span class="selector-class">.less</span>:avnpc<span class="selector-class">.css</span> --watch</span><br></pre></td></tr></table></figure>
<h3 id="avascript篇"><a href="#avascript篇" class="headerlink" title="avascript篇"></a>avascript篇</h3><h4 id="使用requireJS按需加载"><a href="#使用requireJS按需加载" class="headerlink" title="使用requireJS按需加载"></a>使用requireJS按需加载</h4><p>模块加载器的概念可能稍微接触过前端开发的童鞋都不会陌生，通过模块加载器可以有效的解决这些问题：</p>
<ol>
<li>JS文件的依赖关系。</li>
<li>通过异步加载优化script标签引起的阻塞问题</li>
<li>可以简单的以文件为单位将功能模块化并实现复用</li>
</ol>
<p>主流的JS模块加载器有<a href="http://requirejs.org/" target="_blank" rel="noopener">requireJS</a>，<a href="http://seajs.org/docs/" target="_blank" rel="noopener">SeaJS</a>等，加载器之间可能会因为遵循的规范不同有微妙的差别，从纯用户的角度出发，之所以选requireJS而不是SeaJS主要是因为：</p>
<ul>
<li>功能实现上两者相差无几，没有明显的性能差异或重大问题。</li>
<li>文档丰富程度上，requireJS远远好于SeaJS，就拿最简单的加载jQuery和jQuery插件这回事，虽然两者的实现方法相差无几，但requireJS就有可以直接拿来用的Demo，SeaJS还要读文档自己慢慢折腾。一些问题的解决上，requireJS为关键词也更容易找到答案。</li>
</ul>
<h4 id="requireJS-加载jQuery-jQuery插件"><a href="#requireJS-加载jQuery-jQuery插件" class="headerlink" title="requireJS 加载jQuery + jQuery插件"></a>requireJS 加载jQuery + jQuery插件</h4><p>可能对于一般Web App来说，引入jQuery及相关插件的概率是最大的，requireJS也亲切的给出了相应的解决方案及动态加载jQuery及插件的文档及实例代码。</p>
<p>在最新的jQuery1.9.X中，jQuery已经在最后直接将自己注册为一个AMD模块，即是说可以直接被requireJS作为模块加载。如果是加载旧版的jQuery有两种方法：</p>
<ol>
<li>让jQuery先于requireJS加载</li>
<li>对jQuery代码稍做一点处理，在jQuery代码包裹一句：</li>
</ol>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define([<span class="string">"jquery"</span>], <span class="function"><span class="keyword">function</span><span class="params">($)</span> </span>&#123;</span><br><span class="line">   <span class="comment">// $ is guaranteed to be jQuery now */</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>requireJS的示例中，直接将requireJS与jQuery合并为一个文件，如果是采用jQuery作为核心库的话推荐这种做法。</p>
<p>同样对于jQuery插件来说也有两种方法</p>
<p>1. 在插件外包裹代码</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">define([<span class="string">"jquery"</span>], <span class="function"><span class="keyword">function</span><span class="params">($)</span></span>&#123;</span><br><span class="line">    <span class="comment">// Put here the plugin code. </span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>2. 在使用reuqireJS代码加载前注册插件（比如在main.js）中</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">requirejs.config(&#123;</span><br><span class="line">  <span class="string">"shim"</span>: &#123;</span><br><span class="line">     <span class="string">"jquery-cookie"</span>: [<span class="string">"jquery"</span>]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="requireJS加载第三方类库"><a href="#requireJS加载第三方类库" class="headerlink" title="requireJS加载第三方类库"></a>requireJS加载第三方类库</h4><p>在实例的App中还用到了jQuery以外的第三方类库，如果类库不是一个标准的AMD模块而又不想更改这些类库的代码，同样需要提前进行定义：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">require</span><span class="selector-class">.config</span>(&#123;</span><br><span class="line">  <span class="attribute">paths</span>: &#123;</span><br><span class="line">    <span class="string">'underscore'</span>: <span class="string">'vendor/underscore'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="selector-tag">shim</span>: &#123;</span><br><span class="line">    <span class="attribute">underscore</span>: &#123;</span><br><span class="line">      exports: <span class="string">'_'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h4 id="CSS文件的模块化处理"><a href="#CSS文件的模块化处理" class="headerlink" title="CSS文件的模块化处理"></a>CSS文件的模块化处理</h4><p>在requireJS中，模块的概念仅限于JS文件，如果需要加载图片、JSON等非JS文件，requireJS实现了一系列<a href="http://requirejs.org/docs/plugins.html" target="_blank" rel="noopener">加载插件</a>。</p>
<p>但是遗憾的是requireJS官方没有对CSS进行模块化处理，而我们在实际项目中却往往能遇到一些场景，比如一个轮播的图片展示栏，比如高级编辑器等等。几乎所有的富UI组件都会由JS与CSS两部分构成，而CSS之间也存在着模块的概念以及依赖关系。</p>
<p>为了更好的与requireJS整合，这里采用require-css来解决CSS的模块化与依赖问题。</p>
<p>require-css是一个requireJS插件，下载后将css.js与normalize.js放于main.js同级即可默认被加载，比如在我们的项目中需要加载jQuery Mobile的css文件，那么可以直接这样调用：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">'jquery'</span>, <span class="string">'css!../css/jquery.mobile-1.3.0.min.css'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">$</span>) </span>&#123;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>不过由于这个CSS本质上是属于jQuery Mobile模块的一部分，更好的做法是将这个CSS文件的定义放在jQuery Mobile的依赖关系中，最终我们的requireJS定义部分为：</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">require</span><span class="selector-class">.config</span>(&#123;</span><br><span class="line">  <span class="attribute">paths</span>: &#123;</span><br><span class="line">    <span class="string">'jquerymobile'</span>: <span class="string">'vendor/jquery.mobile-1.3.0'</span>,</span><br><span class="line">    <span class="string">'jstorage'</span> : <span class="string">'vendor/jstorage'</span>,</span><br><span class="line">    <span class="string">'underscore'</span>: <span class="string">'vendor/underscore'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="selector-tag">shim</span>: &#123;</span><br><span class="line">    <span class="attribute">jquerymobile </span>: &#123;</span><br><span class="line">      deps: [</span><br><span class="line">      <span class="string">'css!../css/jquery.mobile-1.3.0.min.css'</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="selector-tag">underscore</span>: &#123;  </span><br><span class="line">      <span class="attribute">exports</span>: <span class="string">'_'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>在使用模块时，只需要：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">'jquery'</span>, <span class="string">'underscore'</span>, <span class="string">'jquerymobile'</span>, <span class="string">'jstorage'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">$, _</span>) </span>&#123;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>jQuery Mobile的CSS文件就会被自动加载，这样CSS与JS就被整合为一个模块了。同理其他有复杂依赖关系的模块也可以做类似处理，requireJS会解决依赖关系的逻辑。</p>
<h4 id="数据源的加载与等待"><a href="#数据源的加载与等待" class="headerlink" title="数据源的加载与等待"></a>数据源的加载与等待</h4><p>Web App一般都会动态加载后端的数据，数据格式一般可以是JSON、JSONP也可以直接是一个JS变量。这里以JS变量为例</p>
<figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">var restaurants = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"KFC"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"7-11"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="string">"name"</span>: <span class="string">"成都小吃"</span></span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>载入这段数据:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$.getScript(<span class="string">'data/restaurants.json'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">var</span> data = <span class="built_in">window</span>.restaurants;</span><br><span class="line">  alert(data[<span class="number">0</span>].name); <span class="comment">//KFC</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>单一的数据源确实很简单，但是往往一个应用中会有多个数据源，比如在这个实例App中UI就需要载入用户信息、餐厅信息、订餐信息三种数据后才能工作。如果仅仅靠多层嵌套回调函数的话，可能代码的耦合就非常重了。</p>
<p>为了解决多个数据加载的问题，我习惯的解决方法是构造一个dataReady事件响应机制。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foodOrder = &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//数据载入后要执行的函数暂存在这里</span></span><br><span class="line">  dataReadyFunc : []</span><br><span class="line"></span><br><span class="line">  <span class="comment">//数据源URL及载入状态</span></span><br><span class="line">  , <span class="attr">dataSource</span> : [</span><br><span class="line">      &#123; <span class="attr">url</span> : <span class="string">'data/restaurants.json'</span>, <span class="attr">ready</span> : <span class="literal">false</span>, <span class="attr">data</span> : <span class="literal">null</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">url</span> : <span class="string">'data/users.json'</span>, <span class="attr">ready</span> : <span class="literal">false</span>, <span class="attr">data</span> : <span class="literal">null</span> &#125;,</span><br><span class="line">      &#123; <span class="attr">url</span> : <span class="string">'data/foods.json'</span>, <span class="attr">ready</span> : <span class="literal">false</span>, <span class="attr">data</span> : <span class="literal">null</span> &#125;</span><br><span class="line">  ]</span><br><span class="line"></span><br><span class="line">  <span class="comment">//检查数据源是否全部载入完毕</span></span><br><span class="line">  , <span class="attr">isReady</span> : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> isReady = <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> <span class="keyword">this</span>.dataSource)&#123;</span><br><span class="line">         <span class="keyword">if</span>(<span class="keyword">this</span>.dataSource[key].ready !== <span class="literal">true</span>)&#123;</span><br><span class="line">             isReady = <span class="literal">false</span>;</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> isReady;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//数据源全部加载完毕，则逐一运行dataReadyFunc中存放的函数</span></span><br><span class="line">  , <span class="attr">callReady</span> : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span>(<span class="literal">true</span> === <span class="keyword">this</span>.isReady())&#123;</span><br><span class="line">         <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> <span class="keyword">this</span>.dataReadyFunc)&#123;</span><br><span class="line">             <span class="keyword">this</span>.dataReadyFunc[key]();</span><br><span class="line">         &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//供外部调用，会将外部输入的函数暂存在dataReadyFunc中</span></span><br><span class="line">  , <span class="attr">dataReady</span> : <span class="function"><span class="keyword">function</span>(<span class="params">func</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> func !== <span class="string">'function'</span>) &#123;</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">      &#125; </span><br><span class="line">      <span class="keyword">this</span>.dataReadyFunc.push(func);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  , <span class="attr">init</span> : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">      <span class="keyword">var</span> _initElement = <span class="function"><span class="keyword">function</span>(<span class="params">key, url</span>)</span>&#123;</span><br><span class="line">         $.getScript(url, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</span><br><span class="line">             <span class="comment">//每次载入数据后，将数据存放于dataSource中，将ready状态置为true，并调用callReady</span></span><br><span class="line">             self.dataSource[key].data = <span class="built_in">window</span>[key];</span><br><span class="line">             self.dataSource[key].ready = <span class="literal">true</span>;</span><br><span class="line">             self.callReady();</span><br><span class="line">         &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> <span class="keyword">this</span>.dataSource)&#123;</span><br><span class="line">         _initElement(key, <span class="keyword">this</span>.dataSource[key].url);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>用法为</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">foodOrder.dataReady(function()&#123;</span><br><span class="line">  alert(<span class="number">1</span>)<span class="comment">;     </span></span><br><span class="line">&#125;)<span class="comment">;</span></span><br><span class="line">foodOrder.init()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>dataReady内的alert将会在所有数据载入完毕后开始执行。</p>
<p>这段处理的逻辑并不复杂，将所有要执行的方法通过dataReady暂存起来，等待数据全部加载完毕后再执行，更加复杂的场景此方法仍然通用。</p>
<h4 id="使用JS模板引擎"><a href="#使用JS模板引擎" class="headerlink" title="使用JS模板引擎"></a>使用JS模板引擎</h4><p>数据载入后，最终都会以某种形式显示在页面上。简单情况，我们可能会这样做：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash">(<span class="string">'body'</span>).append(<span class="string">'&lt;div&gt;'</span> + data.name + <span class="string">'&lt;/div&gt;'</span>);</span></span><br></pre></td></tr></table></figure>
<p>如果页面逻辑一旦复杂，比如需要有if判断或者多层循环时，这种连接字符串的方式就相形见绌了，而这也就催生出了JS模板引擎。</p>
<p>主流的JS模板引擎有<a href="http://documentcloud.github.com/underscore/" target="_blank" rel="noopener">underscore.js</a>，<a href="http://jade-lang.com/" target="_blank" rel="noopener">Jade</a>，<a href="http://embeddedjs.com/" target="_blank" rel="noopener">EJS</a>等等，可以<a href="http://engineering.linkedin.com/frontend/client-side-templating-throwdown-mustache-handlebars-dustjs-and-more" target="_blank" rel="noopener">横向对比一下这些JS模板引擎的优缺点</a>。</p>
<p>对于相对简单的页面逻辑（只需要支持if和for/each）来说，我更倾向选用轻巧的<code>underscore.js</code>或者<a href="https://github.com/blueimp/JavaScript-Templates" target="_blank" rel="noopener">JavaScript Templates</a>。</p>
<p>在当前例子中，使用underscore.js生成列表就非常简单了，页面模板为：</p>
<p>在当前例子中，使用underscore.js生成列表就非常简单了，页面模板为：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">data-role</span>=<span class="string">"listview"</span> <span class="attr">data-inset</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">id</span>=<span class="string">"tmpl-restaurants"</span> <span class="attr">type</span>=<span class="string">"text/template"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">   &lt; % _.each(data, <span class="function"><span class="keyword">function</span><span class="params">(restaurant)</span> </span>&#123; %&gt;</span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span></span><br><span class="line"><span class="javascript">           &lt;a href=<span class="string">"#"</span> data-rel=<span class="string">"back"</span> data-value=<span class="string">"&lt;%- restaurant.name%&gt;"</span>&gt;<span class="xml"><span class="tag">&lt; %<span class="attr">-</span> <span class="attr">restaurant.name</span>%&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">       <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">   <span class="tag">&lt; % &#125;); %&gt;</span></span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>调用引擎</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$(</span><span class="string">"#tmpl-restaurants"</span>).replaceWith(</span><br><span class="line">   <span class="number">_</span>.template(<span class="variable">$(</span><span class="string">"#tmpl-restaurants"</span>).html(), &#123;</span><br><span class="line">       data : restaurants</span><br><span class="line">   &#125;)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="面向对象与模块化"><a href="#面向对象与模块化" class="headerlink" title="面向对象与模块化"></a>面向对象与模块化</h4><p>通过上面这些工具的组合，我们有了模块的概念，有了模板引擎，有数据的加载。最终还是要通过javascript将这一切组织在一起并加入应用所需要的逻辑。为了能最大限度的复用代码，用面向对象的方式去组织内容是比较好的选择。</p>
<p>JavaScript虽然原生并不支持面向对象，但是依然可以通过很多方式模拟出面向对象的特性。例子中采用了我个人比较喜欢的一种方式是：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> foodOrder = <span class="function"><span class="keyword">function</span>(<span class="params">ui, options</span>)</span>&#123;</span><br><span class="line">   <span class="comment">//构造函数</span></span><br><span class="line">   <span class="keyword">this</span>.init(ui, options);</span><br><span class="line">&#125;</span><br><span class="line">foodOrder.prototype = &#123;</span><br><span class="line">  defaultUI :  &#123;</span><br><span class="line">      form : <span class="string">'#form-order'</span></span><br><span class="line">  &#125;</span><br><span class="line">  , <span class="attr">defaultOptions</span> : &#123;</span><br><span class="line">      debug : <span class="literal">false</span></span><br><span class="line">  &#125;</span><br><span class="line">  , <span class="attr">init</span> : <span class="function"><span class="keyword">function</span>(<span class="params">ui, options</span>)</span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.ui = $.extend(&#123;&#125;, <span class="keyword">this</span>.defaultUI, ui);</span><br><span class="line">      <span class="keyword">this</span>.options = $.extend(&#123;&#125;, <span class="keyword">this</span>.defaultOptions, options);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> order = <span class="keyword">new</span> foodOrder(&#123;</span><br><span class="line">   form : <span class="string">'#real-form'</span></span><br><span class="line">&#125;, &#123;</span><br><span class="line">   debug : <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>将页面的UI元素以及配置项目抽象出来，在实际构造对象时则可以通过入口参数复写，可以分离整个项目的逻辑与UI，使处理的方式更加灵活。</p>
<div style="clear:both"></div><div class="cc"><p>The <a href="https://blog.naaln.com">Why·Liam·Blog</a> by <a href="https://www.naaln.com" target="_blank" rel="external">WhyLiam</a> is licensed under a <a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">Creative Commons BY-NC-ND 4.0 International License</a>.</p><p>由<a href="https://www.naaln.com" target="_blank" rel="external">WhyLiam</a>创作并维护的<a href="https://blog.naaln.com">Why·Liam·Blog</a>采用创作共用<a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" rel="external">保留署名-非商业-禁止演绎4.0国际许可证</a>。</p><p>本文首发于<a href="https://blog.naaln.com">Why·Liam·Blog (https://blog.naaln.com)</a>，版权所有，侵权必究。</p><p>本文永久链接：<a href="https://blog.naaln.com/2014/08/how-to-start-a-modular-and-scalable-web-app/">https://blog.naaln.com/2014/08/how-to-start-a-modular-and-scalable-web-app/</a></p><p></p></div>
      
    </div>
    
    
    

    
      <div>
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="//ws1.sinaimg.cn/large/006tKfTcgy1fg8gpi7kaaj30by0by74i.jpg" alt="WHY·LIAM wechat" style="width: 200px; max-width: 100%;"/>
    <div>记录生活，研究产品，分享设计，分析数据，讨论科技和商业，不定期扯淡。</div>
</div>

      </div>
    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="//ws1.sinaimg.cn/mw690/006tNc79gy1fm7yqrau7mj30f00ezad5.jpg" alt="WHY·LIAM 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="//ww3.sinaimg.cn/mw690/48910e01gw1evkbfendrjj20ci0ci0uf.jpg" alt="WHY·LIAM 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/web/" rel="tag"># web</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2014/08/how-improve-performance-css-selectors/" rel="next" title="如何提升 CSS 选择器性能">
                <i class="fa fa-chevron-left"></i> 如何提升 CSS 选择器性能
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2014/08/personal-knowledge-management-approach/" rel="prev" title="个人知识管理的方法">
                个人知识管理的方法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="SOHUCS"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="//tva2.sinaimg.cn/crop.0.0.998.998.180/48910e01gw1ef5p6etuzdj20rs0rs771.jpg"
                alt="WHY·LIAM" />
            
              <p class="site-author-name" itemprop="name">WHY·LIAM</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">721</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    <span class="site-state-item-count">4</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    <span class="site-state-item-count">67</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/liszd" target="_blank" title="GitHub" rel="external nofollow">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="http://weibo.com/whyliam" target="_blank" title="微博" rel="external nofollow">
                      
                        <i class="fa fa-fw fa-weibo"></i>微博</a>
                  </span>
                
            </div>
          

          
          
            <div class="cc-license motion-element" itemprop="license">
              <a href="https://creativecommons.org/licenses/by-nc-nd/4.0/" class="cc-opacity" target="_blank" rel="external nofollow">
                <img src="/images/cc-by-nc-nd.svg" alt="Creative Commons" />
              </a>
            </div>
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.naaln.com/" title="纳兰主页" target="_blank">纳兰主页</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://photo.naaln.com/" title="纳兰相册" target="_blank">纳兰相册</a>
                  </li>
                
              </ul>
            </div>
          

          
            
          
          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2003 &mdash; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">WHY·LIAM</span>

  

  
</div>


  



  <div class="powered-by">由 <a class="theme-link" target="_blank" rel="external nofollow" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" rel="external nofollow" href="https://github.com/theme-next/hexo-theme-next">NexT.Muse</a> v6.0.2</div>



  <div class="footer-custom">Hosted by <a target="_blank" rel="external nofollow" href="https://pages.coding.me"><b>Coding Pages</b></a></div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.0.2"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.0.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.0.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.0.2"></script>



  



	





  





  




  
    <script type="text/javascript">
    (function(){
      var appid = 'cytklkKc0';
      var conf = 'prod_b1dd516bbb7f3198591656f99d9ace80';
      var width = window.innerWidth || document.documentElement.clientWidth;
      if (width < 960) {
      window.document.write('<script id="changyan_mobile_js" charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/mobile/wap-js/changyan_mobile.js?client_id=' + appid + '&conf=' + conf + '"><\/script>'); } else { var loadJs=function(d,a){var c=document.getElementsByTagName("head")[0]||document.head||document.documentElement;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("charset","UTF-8");b.setAttribute("src",d);if(typeof a==="function"){if(window.attachEvent){b.onreadystatechange=function(){var e=b.readyState;if(e==="loaded"||e==="complete"){b.onreadystatechange=null;a()}}}else{b.onload=a}}c.appendChild(b)};loadJs("https://changyan.sohu.com/upload/changyan.js",function(){
        window.changyan.api.config({appid:appid,conf:conf})});
      }
    })();
    </script>
    <script type="text/javascript" src="https://assets.changyan.sohu.com/upload/plugins/plugins.count.js"></script>
  







  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=6.0.2"></script>



  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  
  

  

  

  

  

</body>
</html>
